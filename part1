import pandas as pd
import numpy as np
import datetime
nic = pd.read_csv("trainingNic.csv")
nic.head(25)
nic.duplicated(subset=['NIC']).sum()
incomplete=pd.DataFrame(data=nic.count()<10)
print(incomplete.sum())
length=nic.apply(len)
print(length)
for i in range (0,24):
    a = nic.loc[i].at["NIC"]
    b = len(a)
    if b < 10:
        print (a)
import tensorflow as tf
model.summary()
#training
dataset_url = "C:/Users/ASUS/Desktop/MLAssessment2/ML/trainingNic.csv"
training_dataset = (dataset_url,
                    subset='training',
                    batch_size=batch,
                    save_to_dir=None)

validation_dataset =(dataset_url,
                    subset='training',
                    batch_size=batch,
                    save_to_dir=None)

log_dir= "C:/Users/ASUS/Desktop/MLAssessment2/ML/logs"+datetime.datetime.now().strftime("%Y%m%d%H%M%S")

train_num = training_dataset.samples
valid_num = validation_dataset.samples

model.fit(training_dataset,
         epochs=20,
         steps_per_epoch=train_num//batch,
         validation_dataset = validation_dataset,
         validation_steps = valid_num//batch,
         #callbacks=callback_list,
         verbose = 1)
         
         
